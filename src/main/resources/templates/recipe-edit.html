<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recipe Buddy - Edit Recipe</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">
    <link th:href="@{/css/one.css}" rel="stylesheet">
</head>
<body>

<div class="dashboard-container">
    <!-- Sidebar Navigation -->
    <div th:replace="~{fragments/navbar::navbar}"></div>

    <!-- Main Content Area -->
    <div class="main-content">
        <!-- Top Navigation Bar -->
        <nav class="top-navbar">
            <div class="container-fluid">
                <div class="d-flex align-items-center"></div>
                <div class="d-flex align-items-center">
                    <div th:replace="~{fragments/profile-menu :: profile-menu}"></div>
                </div>
            </div>
        </nav>

        <!-- Edit Recipe Content -->
        <div class="dashboard-content">
            <div class="container-fluid py-4">
                <div class="row">
                    <div class="col-lg-10 mx-auto">
                        <div class="form-container">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <h3 class="mb-0">[[#{form.editRecipe}]]</h3>
                                <a th:href="@{/recipes/mine}" class="btn btn-sm btn-outline-secondary">
                                    <i class="bi bi-arrow-left"></i> [[#{form.backToRecipes}]]
                                </a>
                            </div>

                            <form th:action="@{'/recipes/' + ${recipeId}}"
                                  th:method="PUT"
                                  th:object="${recipeUpdateRequest}"
                                  enctype="multipart/form-data"
                                  novalidate>

                                <!-- Basic Information Section -->
                                <div class="row mb-4">
                                    <div class="col-md-8">
                                        <div class="mb-3">
                                            <label class="form-label">[[#{form.recipeTitle}]]</label>
                                            <input type="text" class="form-control" th:field="*{title}"
                                                   th:placeholder="#{form.recipeTitlePlaceholder}">
                                            <p class="alert-warning" th:if="${#fields.hasErrors('title')}"
                                               th:errors="*{title}"></p>
                                        </div>

                                        <div class="mb-3">
                                            <label class="form-label">[[#{form.description}]]</label>
                                            <textarea class="form-control" th:field="*{description}" rows="3"
                                                      th:placeholder="#{form.descriptionPlaceholder}"></textarea>
                                            <p class="alert-warning" th:if="${#fields.hasErrors('description')}"
                                               th:errors="*{description}"></p>
                                        </div>

                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label class="form-label">[[#{form.prepTime}]]</label>
                                                    <input type="number" class="form-control"
                                                           th:field="*{prepTimeMinutes}" min="1">
                                                    <p class="alert-warning"
                                                       th:if="${#fields.hasErrors('prepTimeMinutes')}"
                                                       th:errors="*{prepTimeMinutes}"></p>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label class="form-label">[[#{form.cookTime}]]</label>
                                                    <input type="number" class="form-control"
                                                           th:field="*{cookTimeMinutes}" min="0">
                                                    <p class="alert-warning"
                                                       th:if="${#fields.hasErrors('cookTimeMinutes')}"
                                                       th:errors="*{cookTimeMinutes}"></p>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="mb-3">
                                            <label class="form-label">[[#{form.servings}]]</label>
                                            <input type="number" class="form-control" th:field="*{servingSize}" min="1">
                                            <p class="alert-warning" th:if="${#fields.hasErrors('servingSize')}"
                                               th:errors="*{servingSize}"></p>
                                        </div>

                                        <div class="mb-3">
                                            <label class="form-label d-block">[[#{form.difficultyLevel}]]</label>
                                            <div class="difficulty-options">
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input" type="radio"
                                                           th:field="*{difficultyLevel}" value="EASY" id="easy">
                                                    <label class="form-check-label difficulty-easy" for="easy">
                                                        <i class="bi bi-star"></i> [[#{form.easy}]]</label>
                                                </div>
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input" type="radio"
                                                           th:field="*{difficultyLevel}" value="MEDIUM" id="medium">
                                                    <label class="form-check-label difficulty-medium" for="medium">
                                                        <i class="bi bi-star"></i><i class="bi bi-star"></i> [[#{form.medium}]]</label>
                                                </div>
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input" type="radio"
                                                           th:field="*{difficultyLevel}" value="HARD" id="hard">
                                                    <label class="form-check-label difficulty-hard" for="hard"><i class="bi bi-star"></i>
                                                        <i class="bi bi-star"></i><i class="bi bi-star"></i> [[#{form.hard}]]</label>
                                                </div>
                                            </div>
                                            <p class="alert-warning" th:if="${#fields.hasErrors('difficultyLevel')}"
                                               th:errors="*{difficultyLevel}"></p>
                                        </div>
                                    </div>

                                    <div class="col-md-4">
                                        <label class="form-label">[[#{form.recipeImage}]]</label>
                                        <div class="mt-4">
                                            <p class="text-muted">[[#{form.provideImageUrl}]]</p>
                                            <input type="url" class="form-control" th:field="*{imageUrl}"
                                                   th:placeholder="#{form.imageUrlPlaceholder}">
                                            <div class="form-text">[[#{form.pasteImageLink}]]</div>
                                            <p class="alert-warning" th:if="${#fields.hasErrors('imageUrl')}"
                                               th:errors="*{imageUrl}"></p>
                                            <div class="image-preview mt-3" id="imagePreview">
                                                <img th:if="*{imageUrl}" th:src="*{imageUrl}" alt="Recipe preview"
                                                     class="img-fluid rounded" style="max-height: 200px;">
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="section-divider"></div>

                                <!-- Ingredients Section -->
                                <h4 class="mb-3">[[#{form.ingredients}]]</h4>
                                <div class="mb-3">

                                    <textarea class="form-control" th:field="*{ingredients}" rows="6"
                                              th:placeholder="'Enter ingredients (one per line):\n2 cups all-purpose flour\n1 tsp salt\n3 large eggs\n1/2 cup milk'">
                                    </textarea>
                                    <div class="form-text">[[#{form.textI}]].</div>
                                    <p class="alert-warning" th:if="${#fields.hasErrors('ingredients')}"
                                       th:errors="*{ingredients}"></p>
                                </div>

                                <div class="section-divider"></div>

                                <!-- Instructions Section -->
                                <h4 class="mb-3">[[#{form.instructions}]]</h4>
                                <div class="mb-3">

                                    <textarea class="form-control" th:field="*{instructions}" rows="6"
                                              placeholder="#{form.instructionsPlaceholder}"></textarea>
                                    <p class="alert-warning" th:if="${#fields.hasErrors('instructions')}"
                                       th:errors="*{instructions}"></p>
                                </div>

                                <div class="section-divider"></div>

                                <!-- Categories Section -->
                                <div class="row">
                                    <div class="col-md-6">
                                        <h4 class="mb-3">[[#{form.categories}]]</h4>
                                        <div class="mb-3">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox"
                                                       th:field="*{categoryNames}" value="breakfast"
                                                       id="categoryBreakfast">
                                                <label class="form-check-label" for="categoryBreakfast">[[#{form.breakfast}]]</label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox"
                                                       th:field="*{categoryNames}" value="lunch" id="categoryLunch">
                                                <label class="form-check-label" for="categoryLunch">[[#{form.lunch}]]</label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox"
                                                       th:field="*{categoryNames}" value="dinner" id="categoryDinner">
                                                <label class="form-check-label" for="categoryDinner">[[#{form.dinner}]]</label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox"
                                                       th:field="*{categoryNames}" value="appetizer"
                                                       id="categoryAppetizer">
                                                <label class="form-check-label" for="categoryAppetizer">[[#{form.appetizer}]]</label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox"
                                                       th:field="*{categoryNames}" value="dessert" id="categoryDessert">
                                                <label class="form-check-label" for="categoryDessert">[[#{form.dessert}]]</label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox"
                                                       th:field="*{categoryNames}" value="snack" id="categorySnack">
                                                <label class="form-check-label" for="categorySnack">[[#{form.snack}]]</label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox"
                                                       th:field="*{categoryNames}" value="drink" id="categoryDrink">
                                                <label class="form-check-label" for="categoryDrink">[[#{form.drink}]]</label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox"
                                                       th:field="*{categoryNames}" value="soup" id="categorySoup">
                                                <label class="form-check-label" for="categorySoup">[[#{form.soup}]]</label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox"
                                                       th:field="*{categoryNames}" value="salad" id="categorySalad">
                                                <label class="form-check-label" for="categorySalad">[[#{form.salad}]]</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="section-divider"></div>

                                <!-- Nutritional Information (Optional) -->
                                <h4 class="mb-3">[[#{form.nutritionalInfo}]]</h4>
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="mb-3">
                                            <label class="form-label">[[#{form.caloriesPerServing}]]</label>
                                            <input type="number" class="form-control" th:field="*{calories}" min="0" th:placeholder="#{form.enterValue}">

                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="mb-3">
                                            <label class="form-label">[[#{form.proteinPerServing}]]</label>
                                            <input type="number" class="form-control" th:field="*{protein}" min="0" step="0.1" th:placeholder="#{form.enterValue}">

                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="mb-3">
                                            <label class="form-label">[[#{form.carbsPerServing}]]</label>
                                            <input type="number" class="form-control" th:field="*{carbs}" min="0" step="0.1" th:placeholder="#{form.enterValue}">

                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="mb-3">
                                            <label class="form-label">[[#{form.fat}]]</label>
                                            <input type="number" class="form-control" th:field="*{fat}" min="0" step="0.1" th:placeholder="#{form.enterValue}">

                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="mb-3">
                                            <label class="form-label">[[#{form.fiber}]]</label>
                                            <input type="number" class="form-control" th:field="*{fiber}" min="0" step="0.1" th:placeholder="#{form.enterValue}">

                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="mb-3">
                                            <label class="form-label">[[#{form.sugar}]]</label>
                                            <input type="number" class="form-control" th:field="*{sugar}" min="0" step="0.1" th:placeholder="#{form.enterValue}">

                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="mb-3">
                                            <label class="form-label">[[#{form.sodium}]]</label>
                                            <input type="number" class="form-control" th:field="*{sodium}" min="0" step="0.1" th:placeholder="#{form.enterValue}">

                                        </div>
                                    </div>
                                </div>

                                <div class="section-divider"></div>

                                <!-- Recipe Visibility -->
                                <div class="mb-4">
                                    <h4 class="mb-3">[[#{form.recipeVisibility}]]</h4>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" th:field="*{isPublic}"
                                                       value="true" id="visibilityPublic">
                                                <label class="form-check-label" for="visibilityPublic">
                                                    <i class="bi bi-globe"></i> [[#{form.public}]]
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" th:field="*{isPublic}"
                                                       value="false" id="visibilityPrivate">
                                                <label class="form-check-label" for="visibilityPrivate">
                                                    <i class="bi bi-lock"></i> [[#{form.private}]]
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <p class="alert-warning" th:if="${#fields.hasErrors('isPublic')}"
                                       th:errors="*{isPublic}"></p>
                                </div>

                                <!-- Submit Buttons -->
                                <div class="d-flex justify-content-end gap-2 mt-4">
                                    <a th:href="@{'/recipes/' + ${recipeId}}"
                                       class="btn btn-outline-secondary">[[#{form.cancel}]]</a>
                                    <button type="submit" class="btn btn-primary"><i class="bi bi-pencil"></i> [[#{form.updateRecipe}]]
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>